ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm')
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, fill = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm')
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm')
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm',)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm',aes(p95,n/1000, fill = TH01))
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm')
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', color = TH01)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', color = dfZeros$TH01)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 35,
y = 3 ,
label = paste0(
"correlation: ",
round(cor(dfScatter$n,dfScatter$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 3 ,
label = paste0(
"correlation: ",
round(cor(dfScatter$n,dfScatter$p95),3)
)
)
x = as.data.frame(matrix(rnorm(100), ncol = 10))
x
x$L1 = letters[1:10]
x$L2 = letters[11:20]
x
cor(x[sapply(x, is.numeric)])
x[sapply(x, is.numeric)]
x
x[sapply(x, is.numeric)]
dfZeros
dfTH01s <- dfZeros %>% filter(TH01 == T)
dfTH01s
dfZeros$TH01 = grepl("TH01", p95df$sampleID)
dfTH01s <- dfZeros %>% filter(TH01 == T)
dfNotTH01s <- dfZeros %>% filter(TH01 == F)
dfScatter <- dfZeros
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 3 ,
label = paste0(
"correlation: ",
round(cor(dfScatter$n,dfScatter$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 3 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"correlation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 3 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 20 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 20 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\tcorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 20 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"correlation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 5,
y = 20 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
" correlation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 0,
y = 20 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
" correlation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 20 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
" correlation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 4,
y = 20 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
" correlation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 4,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
" correlation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 4,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 2.5,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 2.7,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
dfZerosOrNotZeros <- outlierResults %>%
select(sampleID, sample) %>%
group_by(sampleID) %>%
count(sample == 0)
dfZeros <- dfZerosOrNotZeros %>%
group_by(sampleID) %>%
filter(`sample == 0` == F)
p95df <- outlierResults %>% group_by(sampleID) %>% summarize(p95 = quantile(sample, 0.95))
dfZeros$p95 = p95df$p95
dfZeros$TH01 = grepl("TH01", p95df$sampleID)
dfTH01s <- dfZeros %>% filter(TH01 == T)
dfNotTH01s <- dfZeros %>% filter(TH01 == F)
dfScatter <- dfZeros
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 2.7,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Unexpressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Unexpressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
dfNotZerosOrNotZeros <- outlierResults %>%
select(sampleID, sample) %>%
group_by(sampleID) %>%
count(sample == 0)
dfNotZeros <- dfNotZerosOrNotZeros %>%
group_by(sampleID) %>%
filter(`sample == 0` == F)
p95df <- outlierResults %>% group_by(sampleID) %>% summarize(p95 = quantile(sample, 0.95))
dfNotZeros$p95 = p95df$p95
dfNotZeros$TH01 = grepl("TH01", p95df$sampleID)
dfTH01s <- dfNotZeros %>% filter(TH01 == T)
dfNotTH01s <- dfNotZeros %>% filter(TH01 == F)
dfScatter <- dfNotZeros
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
dfTH01s <- dfNotZeros %>% filter(TH01 == T)
cor(dfTH01s$n,dfTH01s$p95),3
cor(dfTH01s$n,dfTH01s$p95)
dfTH01s
dfNotZeros$TH01 = grepl("TH01", p95df$sampleID)
dfTH01s <- dfNotZeros %>% filter(TH01 == T)
dfNotTH01s <- dfNotZeros %>% filter(TH01 == F)
dfScatter <- dfNotZeros
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
dfTH01s$n,dfTH01s$p95
dfTH01s$n
dfTH01s$p95
dfNotTH01s
ggplot(dfTH01s,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfNotTH01s,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
?geom_smooth
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'glm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = '', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
ggplot(dfScatter,aes(p95,n/1000, fill = TH01)) + geom_point(aes(p95,n/1000, color = TH01)) +
ylab('Expressed Genes per Thousand') + xlab('95th Percentile per Sample') +
ggtitle('Each Sample\'s Count of Expressed Genes and its 95th Percentile') +
geom_smooth(method = 'lm', aes(color = TH01))+
annotate(
"text",
x = 3,
y = 35 ,
label = paste0(
"correlation TH01: ",
round(cor(dfTH01s$n,dfTH01s$p95),3),
"\ncorrelation Not TH01: ",
round(cor(dfNotTH01s$n,dfNotTH01s$p95),3)
)
)
